fp := fp

_lkdata::
!         U _stkseg	!
!         U _u		!
!         U _locklist	!
{
0000             030f0014  sub     fp,#%001e
0004     5cf9080580000012  ldm     <<%0>>%0012(fp),r8,#6
000c         540280000024  ldl     rr2,<<%0>>%0024
0012             5df2000c  ldl     |<<%0>>%0c|(fp),rr2
0016         140400000004  ldl     rr4,#%00000004
001c                 81f5  add     r5,fp
001e         140200000008  ldl     rr2,#%00000008
0024                 81f3  add     r3,fp
0026             54f6000c  ldl     rr6,|<<%0>>%0c|(fp)
002a                 dce4  calr    _lkfront
002c                 942c  ldl     rr12,rr2
002e                 9c28  testl   rr2
0030         5e0680000274  jp      z,<<%0>>%0274
0036             54f20008  ldl     rr2,|<<%0>>%08|(fp)
003a             5df20000  ldl     |<<%0>>%00|(fp),rr2
003e             54f4000c  ldl     rr4,|<<%0>>%0c|(fp)
0042             31470002  ld      r7,rr4(#%0002)
0046                 a772  bit     r7,#2
0048                 e603  jr      z,%0050
004a             21070080  ld      r7,#%0080
004e                 e801  jr      %0052
0050                 8377  sub     r7,r7
0052                 94c4  ldl     rr4,rr12
0054             54f20004  ldl     rr2,|<<%0>>%04|(fp)
0058                 de64  calr    _locked
005a                 8d24  test    r2
005c         5e0e80000274  jp      nz,<<%0>>%0274
0062                 94c2  ldl     rr2,rr12
0064             0103004a  add     r3,#%004a
0068                 942a  ldl     rr10,rr2
006a             54f2000c  ldl     rr2,|<<%0>>%0c|(fp)
006e             31240002  ld      r4,rr2(#%0002)
0072                 a740  bit     r4,#0
0074                 e602  jr      z,%007a
0076                 8344  sub     r4,r4
0078                 e802  jr      %007e
007a             21040100  ld      r4,#%0100
007e             6ff40010  ld      |<<%0>>%10|(fp),r4
0082         5e0880000256  jp      <<%0>>%0256
0088                 9482  ldl     rr2,rr8
008a                 a939  inc     r3,#10
008c             54f40008  ldl     rr4,|<<%0>>%08|(fp)
0090                 1024  cpl     rr4,@rr2
0092         5e0180000260  jp      lt,<<%0>>%0260
0098             35820006  ldl     rr2,rr8(#%0006)
009c         500280000020  cpl     rr2,<<%0>>%0020
00a2         5e0e80000242  jp      nz,<<%0>>%0242
00a8             3584000a  ldl     rr4,rr8(#%000a)
00ac             50f40004  cpl     rr4,|<<%0>>%04|(fp)
00b0                 ea02  jr      gt,%00b6
00b2                 bd31  ldk     r3,#1
00b4                 e801  jr      %00b8
00b6                 8333  sub     r3,r3
00b8             3584000e  ldl     rr4,rr8(#%000e)
00bc             50f40004  cpl     rr4,|<<%0>>%04|(fp)
00c0                 ea02  jr      gt,%00c6
00c2                 bd42  ldk     r4,#2
00c4                 e801  jr      %00c8
00c6                 8344  sub     r4,r4
00c8                 8143  add     r3,r4
00ca             3584000a  ldl     rr4,rr8(#%000a)
00ce             50f40008  cpl     rr4,|<<%0>>%08|(fp)
00d2                 ea02  jr      gt,%00d8
00d4                 bd44  ldk     r4,#4
00d6                 e801  jr      %00da
00d8                 8344  sub     r4,r4
00da                 8143  add     r3,r4
00dc             3584000e  ldl     rr4,rr8(#%000e)
00e0             50f40008  cpl     rr4,|<<%0>>%08|(fp)
00e4                 ea02  jr      gt,%00ea
00e6                 bd48  ldk     r4,#8
00e8                 e801  jr      %00ec
00ea                 8344  sub     r4,r4
00ec                 8143  add     r3,r4
00ee             31840004  ld      r4,rr8(#%0004)
00f2             07040100  and     r4,#%0100
00f6             4bf40010  cp      r4,|<<%0>>%10|(fp)
00fa                 ee03  jr      nz,%0102
00fc             21040010  ld      r4,#%0010
0100                 e801  jr      %0104
0102                 8344  sub     r4,r4
0104                 8143  add     r3,r4
0106                 a132  ld      r2,r3
0108                 ab23  dec     r2,#4
010a             0b02001b  cp      r2,#%001b
010e         5e0b80000256  jp      ugt,<<%0>>%0256
0114                 b322  rl      r2,#2
0116         54248100002a  ldl     rr4,<<%1>>%002a(r2)    ! ldl  rr4,_lockwstr+%2a(r2) !
011c                 1e48  jp      @rr4
011e             4df40010  test    |<<%0>>%10|(fp)
0122                 e607  jr      z,%0132
0124             3584000a  ldl     rr4,rr8(#%000a)
0128             5df40000  ldl     |<<%0>>%00|(fp),rr4
012c         5e0880000268  jp      <<%0>>%0268
0132             54f20008  ldl     rr2,|<<%0>>%08|(fp)
0136             5df20000  ldl     |<<%0>>%00|(fp),rr2
013a                 94a6  ldl     rr6,rr10
013c             61f50010  ld      r5,|<<%0>>%10|(fp)
0140             54f20004  ldl     rr2,|<<%0>>%04|(fp)
0144                 ddaa  calr    _lockadd
0146                 8d24  test    r2
0148                 e64e  jr      z,%01e6
014a             4df40010  test    |<<%0>>%10|(fp)
014e         5e0e80000274  jp      nz,<<%0>>%0274
0154             3582000a  ldl     rr2,rr8(#%000a)
0158             50f20004  cpl     rr2,|<<%0>>%04|(fp)
015c                 e939  jr      ge,%01d0
015e             54f20004  ldl     rr2,|<<%0>>%04|(fp)
0162             5df20000  ldl     |<<%0>>%00|(fp),rr2
0166             3582000a  ldl     rr2,rr8(#%000a)
016a             21050100  ld      r5,#%0100
016e                 94a6  ldl     rr6,rr10
0170                 ddc0  calr    _lockadd
0172                 8d24  test    r2
0174                 e61d  jr      z,%01b0
0176             4df40010  test    |<<%0>>%10|(fp)
017a                 e669  jr      z,%024e
017c             3582000a  ldl     rr2,rr8(#%000a)
0180             5df20000  ldl     |<<%0>>%00|(fp),rr2
0184                 94a6  ldl     rr6,rr10
0186             61f50010  ld      r5,|<<%0>>%10|(fp)
018a             54f20004  ldl     rr2,|<<%0>>%04|(fp)
018e                 ddcf  calr    _lockadd
0190                 8d24  test    r2
0192                 ee37  jr      nz,%0202
0194         540280000000  ldl     rr2,<<%0>>%0000
019a                 9c28  testl   rr2
019c                 ee2a  jr      nz,%01f2
019e                 1484  ldl     rr4,@rr8
01a0                 1da4  ldl     @rr10,rr4
01a2                 14a6  ldl     rr6,@rr10
01a4                 ddf7  calr    _lockfree
01a6     4c05800000152323  ldb     <<%0>>%0015,#%15
01ae                 e862  jr      %0274
01b0             54f20008  ldl     rr2,|<<%0>>%08|(fp)
01b4             5df20000  ldl     |<<%0>>%00|(fp),rr2
01b8                 14a6  ldl     rr6,@rr10
01ba                 8355  sub     r5,r5
01bc             54f20004  ldl     rr2,|<<%0>>%04|(fp)
01c0                 dde8  calr    _lockadd
01c2                 8d24  test    r2
01c4                 e610  jr      z,%01e6
01c6                 1482  ldl     rr2,@rr8
01c8                 1da2  ldl     @rr10,rr2
01ca                 14a6  ldl     rr6,@rr10
01cc                 de0b  calr    _lockfree
01ce                 e852  jr      %0274
01d0             54f20008  ldl     rr2,|<<%0>>%08|(fp)
01d4             5df20000  ldl     |<<%0>>%00|(fp),rr2
01d8             3582000a  ldl     rr2,rr8(#%000a)
01dc                 8355  sub     r5,r5
01de                 94a6  ldl     rr6,rr10
01e0                 ddf8  calr    _lockadd
01e2                 8d24  test    r2
01e4                 ee47  jr      nz,%0274
01e6                 9482  ldl     rr2,rr8
01e8                 a939  inc     r3,#10
01ea             54f40008  ldl     rr4,|<<%0>>%08|(fp)
01ee                 1d24  ldl     @rr2,rr4
01f0                 e841  jr      %0274
01f2             3582000e  ldl     rr2,rr8(#%000e)
01f6             5df20004  ldl     |<<%0>>%04|(fp),rr2
01fa             50f20008  cpl     rr2,|<<%0>>%08|(fp)
01fe                 ee2b  jr      nz,%0256
0200                 e839  jr      %0274
0202             4df40010  test    |<<%0>>%10|(fp)
0206                 e608  jr      z,%0218
0208             3582000e  ldl     rr2,rr8(#%000e)
020c             5df20004  ldl     |<<%0>>%04|(fp),rr2
0210             50f20008  cpl     rr2,|<<%0>>%08|(fp)
0214                 ee20  jr      nz,%0256
0216                 e82e  jr      %0274
0218             3582000a  ldl     rr2,rr8(#%000a)
021c             50f20004  cpl     rr2,|<<%0>>%04|(fp)
0220                 e916  jr      ge,%024e
0222                 9482  ldl     rr2,rr8
0224                 a93d  inc     r3,#14
0226             54f40004  ldl     rr4,|<<%0>>%04|(fp)
022a                 1d24  ldl     @rr2,rr4
022c                 e814  jr      %0256
022e                 9482  ldl     rr2,rr8
0230                 a939  inc     r3,#10
0232             54f40004  ldl     rr4,|<<%0>>%04|(fp)
0236                 e8db  jr      %01ee
0238             3582000e  ldl     rr2,rr8(#%000e)
023c             50f20004  cpl     rr2,|<<%0>>%04|(fp)
0240                 e602  jr      z,%0246
0242                 948a  ldl     rr10,rr8
0244                 e808  jr      %0256
0246             3582000a  ldl     rr2,rr8(#%000a)
024a             5df20004  ldl     |<<%0>>%04|(fp),rr2
024e                 1482  ldl     rr2,@rr8
0250                 1da2  ldl     @rr10,rr2
0252                 9486  ldl     rr6,rr8
0254                 de4f  calr    _lockfree
0256                 14a8  ldl     rr8,@rr10
0258                 9c88  testl   rr8
025a         5e0e80000088  jp      nz,<<%0>>%0088
0260             54f20008  ldl     rr2,|<<%0>>%08|(fp)
0264             5df20000  ldl     |<<%0>>%00|(fp),rr2
0268                 94a6  ldl     rr6,rr10
026a             61f50010  ld      r5,|<<%0>>%10|(fp)
026e             54f20004  ldl     rr2,|<<%0>>%04|(fp)
0272                 de41  calr    _lockadd
0274     5cf1080580000012  ldm     r8,<<%0>>%0012(fp),#6
027c             010f001e  add     fp,#%001e
0280                 9e08  ret
}

_unlk::
{
0282             030f001c  sub     fp,#%001c
0286     5cf9080580000010  ldm     <<%0>>%0010(fp),r8,#6
028e         540280000024  ldl     rr2,<<%0>>%0024
0294             5df2000c  ldl     |<<%0>>%0c|(fp),rr2
0298         140400000004  ldl     rr4,#%00000004
029e                 81f5  add     r5,fp
02a0         140200000008  ldl     rr2,#%00000008
02a6                 81f3  add     r3,fp
02a8             54f6000c  ldl     rr6,|<<%0>>%0c|(fp)
02ac                 de25  calr    _lkfront
02ae                 942c  ldl     rr12,rr2
02b0                 9c28  testl   rr2
02b2                 e668  jr      z,%0384
02b4             0103004a  add     r3,#%004a
02b8                 942a  ldl     rr10,rr2
02ba                 e861  jr      %037e
02bc             31820004  ld      r2,rr8(#%0004)
02c0                 a724  bit     r2,#4
02c2                 e607  jr      z,%02d2
02c4                 9482  ldl     rr2,rr8
02c6                 a933  inc     r3,#4
02c8                 2324  res     @rr4,#4
02ca                 9486  ldl     rr6,rr8
02cc         5f0080000000  call    _lkdata			! beachte lock.nm - ?????????????????????????? _wakeup?!
02d2             3582000a  ldl     rr2,rr8(#%000a)
02d6             50f20004  cpl     rr2,|<<%0>>%04|(fp)
02da                 e918  jr      ge,%030c
02dc                 9482  ldl     rr2,rr8
02de                 a93d  inc     r3,#14
02e0             54f40008  ldl     rr4,|<<%0>>%08|(fp)
02e4                 1024  cpl     rr4,@rr2
02e6                 e912  jr      ge,%030c
02e8             3582000e  ldl     rr2,rr8(#%000e)
02ec             5df20000  ldl     |<<%0>>%00|(fp),rr2
02f0             31850004  ld      r5,rr8(#%0004)
02f4                 9486  ldl     rr6,rr8
02f6             54f20008  ldl     rr2,|<<%0>>%08|(fp)
02fa                 de85  calr    _lockadd
02fc                 8d24  test    r2
02fe                 ee42  jr      nz,%0384
0300                 9482  ldl     rr2,rr8
0302                 a93d  inc     r3,#14
0304             54f40004  ldl     rr4,|<<%0>>%04|(fp)
0308                 1d24  ldl     @rr2,rr4
030a                 e83c  jr      %0384
030c                 9482  ldl     rr2,rr8
030e                 a939  inc     r3,#10
0310             54f40004  ldl     rr4,|<<%0>>%04|(fp)
0314                 1024  cpl     rr4,@rr2
0316                 ea0c  jr      gt,%0330
0318                 9482  ldl     rr2,rr8
031a                 a93d  inc     r3,#14
031c             54f60008  ldl     rr6,|<<%0>>%08|(fp)
0320                 1026  cpl     rr6,@rr2
0322                 e906  jr      ge,%0330
0324                 9482  ldl     rr2,rr8
0326                 a939  inc     r3,#10
0328             54f00008  ldl     rr0,|<<%0>>%08|(fp)
032c                 1d20  ldl     @rr2,rr0
032e                 e82a  jr      %0384
0330                 9482  ldl     rr2,rr8
0332                 a93d  inc     r3,#14
0334             54f40004  ldl     rr4,|<<%0>>%04|(fp)
0338                 1d24  ldl     @rr2,rr4
033a                 948a  ldl     rr10,rr8
033c                 e820  jr      %037e
033e             35820006  ldl     rr2,rr8(#%0006)
0342         500280000020  cpl     rr2,<<%0>>%0020
0348                 eef8  jr      nz,%033a
034a                 9482  ldl     rr2,rr8
034c                 a939  inc     r3,#10
034e             54f40008  ldl     rr4,|<<%0>>%08|(fp)
0352                 1024  cpl     rr4,@rr2
0354                 e217  jr      le,%0384
0356             3582000e  ldl     rr2,rr8(#%000e)
035a             50f20004  cpl     rr2,|<<%0>>%04|(fp)
035e                 e2ed  jr      le,%033a
0360                 9482  ldl     rr2,rr8
0362                 a939  inc     r3,#10
0364             54f40004  ldl     rr4,|<<%0>>%04|(fp)
0368                 1024  cpl     rr4,@rr2
036a                 eaa8  jr      gt,%02bc
036c             3582000e  ldl     rr2,rr8(#%000e)
0370             50f20008  cpl     rr2,|<<%0>>%08|(fp)
0374                 eaa3  jr      gt,%02bc
0376                 1482  ldl     rr2,@rr8
0378                 1da2  ldl     @rr10,rr2
037a                 9486  ldl     rr6,rr8
037c                 dee3  calr    _lockfree
037e                 14a8  ldl     rr8,@rr10
0380                 9c88  testl   rr8
0382                 eedd  jr      nz,%033e
0384     5cf1080580000010  ldm     r8,<<%0>>%0010(fp),#6
038c             010f001c  add     fp,#%001c
0390                 9e08  ret
}

_locked::
{
0392             030f001e  sub     fp,#%001e
0396     5cf9080580000012  ldm     <<%0>>%0012(fp),r8,#6
039e             6ff7000a  ld      |<<%0>>%0a|(fp),r7
03a2         54f880000022  ldl     rr8,<<%0>>%0022(fp)
03a8                 942a  ldl     rr10,rr2
03aa                 944c  ldl     rr12,rr4
03ac             35c2004a  ldl     rr2,rr12(#%004a)
03b0             5df2000c  ldl     |<<%0>>%0c|(fp),rr2
03b4                 e83e  jr      %0432
03b6             54f2000c  ldl     rr2,|<<%0>>%0c|(fp)
03ba                 1424  ldl     rr4,@rr2
03bc             5df4000c  ldl     |<<%0>>%0c|(fp),rr4
03c0                 e838  jr      %0432
03c2                 a939  inc     r3,#10
03c4                 1028  cpl     rr8,@rr2
03c6                 e239  jr      le,%043a
03c8             54f2000c  ldl     rr2,|<<%0>>%0c|(fp)
03cc             35240006  ldl     rr4,rr2(#%0006)
03d0         500480000020  cpl     rr4,<<%0>>%0020
03d6                 e6ef  jr      z,%03b6
03d8                 a93d  inc     r3,#14
03da                 102a  cpl     rr10,@rr2
03dc                 e9ec  jr      ge,%03b6
03de             54f2000c  ldl     rr2,|<<%0>>%0c|(fp)
03e2                 a933  inc     r3,#4
03e4             61f4000a  ld      r4,|<<%0>>%0a|(fp)
03e8             07040100  and     r4,#%0100
03ec                 0724  and     r4,@rr2
03ee                 eee3  jr      nz,%03b6
03f0             67f7000a  bit     |<<%0>>%0a|(fp),#7
03f4                 e606  jr      z,%0402
03f6     4c05800000150d0d  ldb     <<%0>>%0015,#%15
03fe                 bd21  ldk     r2,#1
0400                 e81d  jr      %043c
0402             54f6000c  ldl     rr6,|<<%0>>%0c|(fp)
0406                 dfdf  calr    _deadlock
0408                 8d24  test    r2
040a                 eef9  jr      nz,%03fe
040c             54f2000c  ldl     rr2,|<<%0>>%0c|(fp)
0410                 a933  inc     r3,#4
0412                 2524  set     @rr4,#4
0414             54f6000c  ldl     rr6,|<<%0>>%0c|(fp)
0418             21050028  ld      r5,#%0028
041c         5f0080000000  call    _lkdata			! beachte lock.nm - ?????????????????????????? _sleep?!
0422             35c2004a  ldl     rr2,rr12(#%004a)
0426             5df2000c  ldl     |<<%0>>%0c|(fp),rr2
042a         4c0480000015  testb   <<%0>>%0015
0430                 eee6  jr      nz,%03fe
0432             54f2000c  ldl     rr2,|<<%0>>%0c|(fp)
0436                 9c28  testl   rr2
0438                 eec4  jr      nz,%03c2
043a                 8322  sub     r2,r2
043c     5cf1080580000012  ldm     r8,<<%0>>%0012(fp),#6
0444             010f001e  add     fp,#%001e
0448                 9e08  ret
}

_deadlock::
!        U _Nflock!
{
044a             030f0012  sub     fp,#%0012
044e     5cf90a038000000a  ldm     <<%0>>%000a(fp),r10,#4
0456                 946c  ldl     rr12,rr6
0458                 e821  jr      %049c
045a             35c20006  ldl     rr2,rr12(#%0006)
045e             35240016  ldl     rr4,rr2(#%0016)
0462                 944a  ldl     rr10,rr4
0464         100400000000  cpl     rr4,#%00000000
046a                 e71d  jr      c,%04a6
046c         610380000000  ld      r3,<<%0>>%0000
0472             19020012  mult    rr2,#%0012
0476         140400000000  ldl     rr4,#%00000000
047c                 8135  add     r5,r3
047e                 904a  cpl     rr10,rr4
0480                 ef12  jr      nc,%04a6
0482             35a20006  ldl     rr2,rr10(#%0006)
0486         500280000020  cpl     rr2,<<%0>>%0020
048c                 ee06  jr      nz,%049a
048e     4c05800000152323  ldb     <<%0>>%0015,#%15
0496                 bd21  ldk     r2,#1
0498                 e807  jr      %04a8
049a                 94ac  ldl     rr12,rr10
049c             35c20006  ldl     rr2,rr12(#%0006)
04a0             0c210101  cpb     @rr2,#%01
04a4                 e6da  jr      z,%045a
04a6                 8322  sub     r2,r2
04a8     5cf10a038000000a  ldm     r10,<<%0>>%000a(fp),#4
04b0             010f0012  add     fp,#%0012
04b4                 9e08  ret
}

_unlock::
{
04b6             030f001c  sub     fp,#%001c
04ba     5cf9080580000010  ldm     <<%0>>%0010(fp),r8,#6
04c2                 946c  ldl     rr12,rr6
04c4             35c2004a  ldl     rr2,rr12(#%004a)
04c8                 9c28  testl   rr2
04ca                 e636  jr      z,%0538
04cc                 9462  ldl     rr2,rr6
04ce             0103004a  add     r3,#%004a
04d2                 9428  ldl     rr8,rr2
04d4             4df8000e  clr     |<<%0>>%0e|(fp)
04d8             4df8000c  clr     |<<%0>>%0c|(fp)
04dc             61f2000c  ld      r2,|<<%0>>%0c|(fp)
04e0             b3290002  sla     r2,#2
04e4         542480000068  ldl     rr4,<<%0>>%0068(r2)
04ea                 9c48  testl   rr4
04ec                 e60c  jr      z,%0506
04ee             61f2000c  ld      r2,|<<%0>>%0c|(fp)
04f2             b3290002  sla     r2,#2
04f6         542480000068  ldl     rr4,<<%0>>%0068(r2)
04fc                 a951  inc     r5,#2
04fe                 104c  cpl     rr12,@rr4
0500                 ee02  jr      nz,%0506
0502             69f0000e  inc     |<<%0>>%0e|(fp),#1
0506             69f0000c  inc     |<<%0>>%0c|(fp),#1
050a         4df1000c0014  cp      |<<%0>>%0c|(fp),#%0014
0510                 e1e5  jr      lt,%04dc
0512             4df4000e  test    |<<%0>>%0e|(fp)
0516                 e60d  jr      z,%0532
0518                 e80f  jr      %0538
051a                 14a2  ldl     rr2,@rr10
051c                 1d82  ldl     @rr8,rr2
051e                 94a6  ldl     rr6,rr10
0520                 dfb5  calr    _lockfree
0522                 e807  jr      %0532
0524             35a20006  ldl     rr2,rr10(#%0006)
0528         500280000020  cpl     rr2,<<%0>>%0020
052e                 e6f5  jr      z,%051a
0530                 94a8  ldl     rr8,rr10
0532                 148a  ldl     rr10,@rr8
0534                 9ca8  testl   rr10
0536                 eef6  jr      nz,%0524
0538     5cf1080580000010  ldm     r8,<<%0>>%0010(fp),#6
0540             010f001c  add     fp,#%001c
0544                 9e08  ret
}

_lockalloc::
{
0546                 abfb  dec     fp,#12
0548     5cf90a0380000004  ldm     <<%0>>%0004(fp),r10,#4
0550         140c00000000  ldl     rr12,#%00000000
0556             35c20006  ldl     rr2,rr12(#%0006)
055a                 9c28  testl   rr2
055c                 ee19  jr      nz,%0590
055e                 94c2  ldl     rr2,rr12
0560                 a935  inc     r3,#6
0562         140400000000  ldl     rr4,#%00000000
0568                 1d24  ldl     @rr2,rr4
056a         140a00000012  ldl     rr10,#%00000012
0570                 e804  jr      %057a
0572                 94a6  ldl     rr6,rr10
0574                 dfdf  calr    _lockfree
0576             010b0012  add     r11,#%0012
057a         610380000000  ld      r3,<<%0>>%0000
0580             19020012  mult    rr2,#%0012
0584         140400000000  ldl     rr4,#%00000000
058a                 8135  add     r5,r3
058c                 904a  cpl     rr10,rr4
058e                 e7f1  jr      c,%0572
0590                 14ca  ldl     rr10,@rr12
0592                 9ca8  testl   rr10
0594                 ee06  jr      nz,%05a2
0596     4c05800000152323  ldb     <<%0>>%0015,#%15
059e                 9222  subl    rr2,rr2
05a0                 e805  jr      %05ac
05a2                 14a2  ldl     rr2,@rr10
05a4                 1dc2  ldl     @rr12,rr2
05a6                 9222  subl    rr2,rr2
05a8                 1da2  ldl     @rr10,rr2
05aa                 94a2  ldl     rr2,rr10
05ac     5cf10a0380000004  ldm     r10,<<%0>>%0004(fp),#4
05b4                 a9fb  inc     fp,#12
05b6                 9e08  ret
}

_lockfree::
{
05b8                 abfb  dec     fp,#12
05ba     5cf90a0380000004  ldm     <<%0>>%0004(fp),r10,#4
05c2                 946c  ldl     rr12,rr6
05c4         140a00000000  ldl     rr10,#%00000000
05ca             31c20004  ld      r2,rr12(#%0004)
05ce                 a724  bit     r2,#4
05d0                 e607  jr      z,%05e0
05d2                 9462  ldl     rr2,rr6
05d4                 a933  inc     r3,#4
05d6                 2324  res     @rr4,#4
05d8                 94c6  ldl     rr6,rr12
05da         5f0080000000  call    _lkdata			! beachte lock.nm - ?????????????????????????? _wakeup?!
05e0                 14a2  ldl     rr2,@rr10
05e2                 1dc2  ldl     @rr12,rr2
05e4                 1dac  ldl     @rr10,rr12
05e6     5cf10a0380000004  ldm     r10,<<%0>>%0004(fp),#4
05ee                 a9fb  inc     fp,#12
05f0                 9e08  ret
}

_lockadd::
{
05f2             030f001e  sub     fp,#%001e
05f6     5cf9080580000012  ldm     <<%0>>%0012(fp),r8,#6
05fe                 9428  ldl     rr8,rr2
0600                 a15b  ld      r11,r5
0602                 946c  ldl     rr12,rr6
0604                 d060  calr    _lockalloc
0606             5df2000c  ldl     |<<%0>>%0c|(fp),rr2
060a                 9c28  testl   rr2
060c                 ee06  jr      nz,%061a
060e     4c05800000152323  ldb     <<%0>>%0015,#%15
0616                 bd21  ldk     r2,#1
0618                 e81e  jr      %0656
061a             54f2000c  ldl     rr2,|<<%0>>%0c|(fp)
061e                 14c4  ldl     rr4,@rr12
0620                 1d24  ldl     @rr2,rr4
0622             54f4000c  ldl     rr4,|<<%0>>%0c|(fp)
0626                 1dc4  ldl     @rr12,rr4
0628             54f2000c  ldl     rr2,|<<%0>>%0c|(fp)
062c                 a935  inc     r3,#6
062e         540480000020  ldl     rr4,<<%0>>%0020
0634                 1d24  ldl     @rr2,rr4
0636             54f2000c  ldl     rr2,|<<%0>>%0c|(fp)
063a                 a939  inc     r3,#10
063c                 1d28  ldl     @rr2,rr8
063e             54f2000c  ldl     rr2,|<<%0>>%0c|(fp)
0642                 a93d  inc     r3,#14
0644         54f480000022  ldl     rr4,<<%0>>%0022(fp)
064a                 1d24  ldl     @rr2,rr4
064c             54f2000c  ldl     rr2,|<<%0>>%0c|(fp)
0650                 a933  inc     r3,#4
0652                 2f2b  ld      @rr2,r11
0654                 8322  sub     r2,r2
0656     5cf1080580000012  ldm     r8,<<%0>>%0012(fp),#6
065e             010f001e  add     fp,#%001e
0662                 9e08  ret
}

_lkfront::
{
0664             030f0030  sub     fp,#%0030
0668     5cf9080580000024  ldm     <<%0>>%0024(fp),r8,#6
0670                 9428  ldl     rr8,rr2
0672                 944a  ldl     rr10,rr4
0674                 946c  ldl     rr12,rr6
0676                 21c7  ld      r7,@rr12
0678         5f0080000000  call    _lkdata			! beachte lock.nm - ?????????????????????????? _getf?!
067e             5df20016  ldl     |<<%0>>%16|(fp),rr2
0682                 9c28  testl   rr2
0684                 ee1f  jr      nz,%06c4
0686                 e84f  jr      %0726
0688         14060100009a  ldl     rr6,#%0100009a
068e         5f0080000000  call    _lkdata			! beachte lock.nm - ?????????????????????????? _printf?!
0694                 e848  jr      %0726
0696             54f6001a  ldl     rr6,|<<%0>>%1a|(fp)
069a             21050080  ld      r5,#%0080
069e         5f0080000000  call    _lkdata			! beachte lock.nm - ?????????????????????????? _access?!
06a4                 8d24  test    r2
06a6                 e61e  jr      z,%06e4
06a8     4c05800000150d0d  ldb     <<%0>>%0015,#%15
06b0                 e83a  jr      %0726
06b2             31240006  ld      r4,rr2(#%0006)
06b6                 a74c  bit     r4,#12
06b8                 e6f7  jr      z,%06a8
06ba     4c05800000151d1d  ldb     <<%0>>%0015,#%15
06c2                 e831  jr      %0726
06c4             54f20016  ldl     rr2,|<<%0>>%16|(fp)
06c8             35240002  ldl     rr4,rr2(#%0002)
06cc             5df4001a  ldl     |<<%0>>%1a|(fp),rr4
06d0                 9c48  testl   rr4
06d2                 e6da  jr      z,%0688
06d4             54f20016  ldl     rr2,|<<%0>>%16|(fp)
06d8                 202c  ldb     rl4,@rr2
06da                 b140  extsb   r4
06dc             07040002  and     r4,#%0002
06e0                 8d44  test    r4
06e2                 e6d9  jr      z,%0696
06e4         4df5001e7000  ld      |<<%0>>%1e|(fp),#%7000
06ea             54f2001a  ldl     rr2,|<<%0>>%1a|(fp)
06ee             31240006  ld      r4,rr2(#%0006)
06f2             0704f000  and     r4,#%f000
06f6             47f4001e  and     r4,|<<%0>>%1e|(fp)
06fa                 eedb  jr      nz,%06b2
06fc             35c60004  ldl     rr6,rr12(#%0004)
0700         14040000000c  ldl     rr4,#%0000000c
0706                 81f5  add     r5,fp
0708                 bd3a  ldk     r3,#10
070a         5f0080000000  call    _lkdata			! beachte lock.nm - ?????????????????????????? _copyin?!
0710                 8d24  test    r2
0712                 e60b  jr      z,%072a
0714     4c05800000150e0e  ldb     <<%0>>%0015,#%15
071c                 e804  jr      %0726
071e     4c05800000151616  ldb     <<%0>>%0015,#%15
0726                 9222  subl    rr2,rr2
0728                 e842  jr      %07ae
072a             31c20002  ld      r2,rr12(#%0002)
072e             0b020000  cp      r2,#%0000
0732                 e1f5  jr      lt,%071e
0734             0b020007  cp      r2,#%0007
0738                 eaf2  jr      gt,%071e
073a                 a721  bit     r2,#1
073c                 e619  jr      z,%0770
073e         4df100140001  cp      |<<%0>>%14|(fp),#%0001
0744                 ee05  jr      nz,%0750
0746             54f20016  ldl     rr2,|<<%0>>%16|(fp)
074a             35240006  ldl     rr4,rr2(#%0006)
074e                 e808  jr      %0760
0750         4df100140002  cp      |<<%0>>%14|(fp),#%0002
0756                 ee08  jr      nz,%0768
0758             54f2001a  ldl     rr2,|<<%0>>%1a|(fp)
075c             3524000e  ldl     rr4,rr2(#%000e)
0760             56f40010  addl    rr4,|<<%0>>%10|(fp)
0764             5df40010  ldl     |<<%0>>%10|(fp),rr4
0768             54f20010  ldl     rr2,|<<%0>>%10|(fp)
076c                 1da2  ldl     @rr10,rr2
076e                 e805  jr      %077a
0770             54f20016  ldl     rr2,|<<%0>>%16|(fp)
0774             35240006  ldl     rr4,rr2(#%0006)
0778                 1da4  ldl     @rr10,rr4
077a                 14a2  ldl     rr2,@rr10
077c         100200000000  cpl     rr2,#%00000000
0782                 e1cd  jr      lt,%071e
0784             54f2000c  ldl     rr2,|<<%0>>%0c|(fp)
0788                 9c28  testl   rr2
078a                 e604  jr      z,%0794
078c                 14a2  ldl     rr2,@rr10
078e             56f2000c  addl    rr2,|<<%0>>%0c|(fp)
0792                 e803  jr      %079a
0794         140240000000  ldl     rr2,#%40000000
079a                 1d82  ldl     @rr8,rr2
079c                 14a2  ldl     rr2,@rr10
079e                 1082  cpl     rr2,@rr8
07a0                 e9be  jr      ge,%071e
07a2                 14a2  ldl     rr2,@rr10
07a4         5d0280000028  ldl     <<%0>>%0028,rr2
07aa             54f2001a  ldl     rr2,|<<%0>>%1a|(fp)
07ae     5cf1080580000024  ldm     r8,<<%0>>%0024(fp),#6
07b6             010f0030  add     fp,#%0030
07ba                 9e08  ret
}
